{% extends "base.html" %}
{% block title %}NPACT - Management{% endblock %}

{% block addScript %}
<script src="{{ url_for('static', filename='css/custom-theme/jquery-ui.min.js')}}"></script>
<script src="{{ url_for('static', filename='bower_components/qtip2/jquery.qtip.min.js')}}"></script>
<script type="text/javascript">
</script>
{% endblock %}

{%block content %}
<div class="contentPadding">
  <h2>NPACT - Management</h2>
  <div id="msgpane" class="ui-corner-all">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    {% for message in messages %}
    <div class="message">
      <p class="ui-state-highlight ui-corner-all ui-state-error">
        {{ message }}</p>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
  </div>

  <form  method="POST">
    <h3>Taskqueue daemon</h3>
    <div>
      <p>This is the background working daemon in which the heavy lifting takes place.</p>
      <p>Current status: <span class="orange-text">{{daemon_status}}</span></p>
      <ul>
        {% if daemon_status == 'stopped' %}
        <li><button type="submit" name="action" value="start-daemon">Start Daemon</button></li>
        {% else %}
        <li><button type="submit" name="action" value="restart-daemon">Restart Daemon</button></li>
        {% endif %}
        <li><button type="submit" name="action" value="kill-daemon">Kill any daemon processes</button></li>
      </ul>
    </div>
    <h3>Cleanup</h3>
    <div>
      <p>This needs to be done from time to time to help prevent disk space usage from going crazy</p>
      <p>
        <label>Cleanup files older than:
          <input type="text" name="days" size="2" value="{{ default_atime }}"/> days.
        </label>
        <button type="submit" name="action" value="cleanup">Run Cleanup</button>
      </p>
    </div>
    <div>
      <label>Cleanout library:</label>
      <button type="submit" name="action" value="clear-library">Clear Library</button>
    </div>
  </form>

</div>
{%endblock content %}
